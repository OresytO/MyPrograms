DROP TABLE IF EXISTS "USERS_ROLES";
DROP TABLE IF EXISTS "VISIT";
DROP TABLE IF EXISTS "VISITOR";
DROP TABLE IF EXISTS "USER";
DROP TABLE IF EXISTS "ROLE";

CREATE TABLE "USER" (
  ID            INTEGER PRIMARY KEY,
  USER_NAME     VARCHAR(255)        NOT NULL,
  USER_NICKNAME VARCHAR(255) UNIQUE NOT NULL,
  PASSWORD      VARCHAR(255)        NOT NULL,
  ENABLE        BOOLEAN             NOT NULL
);
INSERT INTO "USER" VALUES
  (1, 'admin', 'admin', 'admin', TRUE),
  (2, 'orest', 'director', 'oresyto', TRUE),
  (3, 'orest', 'manager', 'oresyto', TRUE);

CREATE TABLE "ROLE" (
  ID        INTEGER PRIMARY KEY,
  ROLE_NAME VARCHAR(255) UNIQUE NOT NULL
);
INSERT INTO "ROLE" VALUES
  (1, 'admin'),
  (2, 'director'),
  (3, 'manager');

CREATE TABLE "USERS_ROLES" (
  ID      INTEGER PRIMARY KEY,
  USER_ID INTEGER REFERENCES "USER" (id),
  ROLE_ID INTEGER REFERENCES "ROLE" (id)
);
INSERT INTO "USERS_ROLES" VALUES
  (1, 1, 1),
  (2, 1, 2),
  (3, 1, 3),
  (4, 2, 2),
  (5, 2, 3),
  (6, 3, 3);

CREATE TABLE "VISITOR" (
  ID          INTEGER PRIMARY KEY,
  NAME        VARCHAR(255) NOT NULL,
  CREATE_DATE DATE         NOT NULL DEFAULT CURRENT_TIMESTAMP
);
INSERT INTO "VISITOR" VALUES
  (1, 'admin'),
  (2, 'orest');

CREATE TABLE "VISIT" (
  ID            INTEGER PRIMARY KEY,
  VISITOR_ID    INTEGER REFERENCES "VISITOR" (id),
  DATE_OF_VISIT DATE NOT NULL DEFAULT CURRENT_TIMESTAMP
);
INSERT INTO "VISIT" VALUES
  (1, 2),
  (2, 2);

SELECT *
FROM "VISIT";
SELECT *
FROM "VISITOR";
SELECT *
FROM "USERS_ROLES";
SELECT *
FROM "ROLE";
SELECT *
FROM "USER";
